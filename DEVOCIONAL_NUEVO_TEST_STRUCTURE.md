# Devocional Nuevo - Test Folder Structure

This document provides a comprehensive view of the `test/` folder structure with direct links to each test file in the repository.

## Repository Base URL
**Branch:** develop  
**Base URL:** https://github.com/develop4God/Devocional_nuevo/blob/develop/

## Test Folder Structure

### üìÅ test/
Root level test files and setup
- [bible_text_formatter_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/bible_text_formatter_test.dart)
- [devocional_provider_offline_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/devocional_provider_offline_test.dart)
- [devocional_reading_logic_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/devocional_reading_logic_test.dart)
- [devocionales_page_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/devocionales_page_test.dart)
- [devocionales_tracking_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/devocionales_tracking_test.dart)
- [in_app_review_service_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/in_app_review_service_test.dart) ‚≠ê **New Feature Tests**
- [issue_46_integration_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/issue_46_integration_test.dart)
- [mocks.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/mocks.dart)
- [mocks.mocks.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/mocks.mocks.dart)
- [multilingual_tts_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/multilingual_tts_test.dart)
- [offline_manager_widget_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/offline_manager_widget_test.dart)
- [ordinal_formatting_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/ordinal_formatting_test.dart)
- [prayer_functionality_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/prayer_functionality_test.dart)
- [spiritual_stats_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/spiritual_stats_test.dart)
- [test_config.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/test_config.dart)
- [test_setup.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/test_setup.dart)

### üìÅ test/unit/
Unit tests organized by category

#### Main Unit Tests
- [application_language_page_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/application_language_page_test.dart)
- [download_fallback_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/download_fallback_test.dart)
- [download_fallback_test_old.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/download_fallback_test_old.dart)
- [language_change_functionality_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/language_change_functionality_test.dart)
- [translation_validation_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/translation_validation_test.dart)
- [translation_validation_test_old.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/translation_validation_test_old.dart)
- [tts_voice_gender_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/tts_voice_gender_test.dart)

#### üìÅ test/unit/controllers/
Controller layer tests
- [audio_controller_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/controllers/audio_controller_test.dart)

#### üìÅ test/unit/extensions/
Extension tests
- [string_extensions_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/extensions/string_extensions_test.dart)

#### üìÅ test/unit/providers/
Provider layer tests
- [devocional_provider_comprehensive_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/providers/devocional_provider_comprehensive_test.dart)
- [devocional_provider_multilingual_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/providers/devocional_provider_multilingual_test.dart)
- [devocional_provider_simple_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/providers/devocional_provider_simple_test.dart)
- [localization_provider_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/providers/localization_provider_test.dart)
- [offline_download_functionality_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/providers/offline_download_functionality_test.dart)

#### üìÅ test/unit/services/
Service layer tests
- [localization_service_comprehensive_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/localization_service_comprehensive_test.dart)
- [localization_service_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/localization_service_test.dart)
- [translation_validation_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/translation_validation_test.dart)
- [tts_service_multilingual_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/tts_service_multilingual_test.dart)
- [tts_service_unit_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/tts_service_unit_test.dart)
- [tts_translation_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/tts_translation_test.dart)
- [tts_voice_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/services/tts_voice_test.dart)

#### üìÅ test/unit/utils/
Utility function tests
- [constants_validation_test.dart](https://github.com/develop4God/Devocional_nuevo/blob/develop/test/unit/utils/constants_validation_test.dart)

## Test Coverage Summary

### üß™ Test Categories

#### Integration Tests
- **Devocional Page Integration:** Full page functionality testing
- **Offline Functionality:** Complete offline mode testing
- **Reading Logic:** End-to-end devotional reading flow
- **Prayer System:** Complete prayer functionality
- **Issue-Specific Tests:** Targeted bug fix validation

#### Unit Tests by Layer

##### Controllers (1 test file)
- **Audio Controller:** Audio playback and control logic

##### Extensions (1 test file)
- **String Extensions:** String utility method validation

##### Providers (5 test files)
- **Devocional Provider:** Core devotional state management
- **Localization Provider:** Language switching and management
- **Offline Provider:** Download and offline functionality

##### Services (7 test files)
- **Localization Service:** Translation and language management
- **TTS Service:** Text-to-speech functionality across languages
- **In-App Review Service:** ‚≠ê **36 comprehensive test cases**

##### Utils (1 test file)
- **Constants Validation:** Application constants verification

### üéØ In-App Review Test Coverage (NEW)

The In-App Review service includes **36 comprehensive test cases** covering:

#### Core Functionality (17 tests)
- ‚úÖ Milestone detection (5, 25, 50, 100, 200)
- ‚úÖ Non-milestone validation
- ‚úÖ User preference handling (rated, never ask again)
- ‚úÖ Cooldown period testing (90-day global, 30-day remind later)
- ‚úÖ Edge case protection (negative values, zero, large numbers)

#### First-Time User Logic (8 tests)
- ‚úÖ Existing users with 5+ devotionals get review opportunity
- ‚úÖ First-time check only triggers once
- ‚úÖ Cooldown periods respected for first-time users
- ‚úÖ Milestone logic after first-time check

#### Integration Tests (8 tests)
- ‚úÖ Context lifecycle and BuildContext safety
- ‚úÖ Stats service integration
- ‚úÖ Async sequencing validation
- ‚úÖ Concurrency safety
- ‚úÖ Error handling isolation

#### Debug Mode Tests (2 tests)
- ‚úÖ kDebugMode fallback behavior
- ‚úÖ Unmounted context handling

#### Widget Tests (1 test)
- ‚úÖ UI integration with proper context management

### üîß Test Infrastructure

#### Mock Support
- **mocks.dart/mocks.mocks.dart:** Generated mocks for testing
- **test_config.dart:** Centralized test configuration
- **test_setup.dart:** Common test setup utilities

#### Specialized Testing
- **Multilingual Testing:** TTS and localization across 4 languages
- **Offline Testing:** Complete offline functionality validation
- **Voice Testing:** TTS voice selection and gender preferences
- **Translation Testing:** Comprehensive translation validation

## Test Execution

### Running All Tests
```bash
flutter test
```

### Running Specific Test Categories
```bash
# Run only In-App Review tests
flutter test test/in_app_review_service_test.dart

# Run all unit tests
flutter test test/unit/

# Run integration tests
flutter test test/ --exclude-tags=unit
```

### Test Statistics
- **Total Test Files:** 38 files
- **Unit Tests:** 15+ test suites
- **Integration Tests:** 8+ test suites
- **Mock Files:** 2 files
- **Setup/Config Files:** 2 files

## Quality Assurance

### Coverage Areas
- ‚úÖ **Core Functionality:** All major features tested
- ‚úÖ **Multilingual Support:** 4 languages validated
- ‚úÖ **Offline Functionality:** Complete offline mode coverage
- ‚úÖ **Audio Features:** TTS and voice functionality
- ‚úÖ **State Management:** Provider and BLoC patterns
- ‚úÖ **User Experience:** UI components and interactions
- ‚úÖ **Edge Cases:** Error handling and boundary conditions
- ‚úÖ **Performance:** Async operations and concurrency

### Recent Additions
- ‚≠ê **In-App Review Testing:** 36 comprehensive test cases
- ‚≠ê **First-Time User Logic:** Coverage for existing users
- ‚≠ê **Debug Mode Testing:** Development environment support
- ‚≠ê **Integration Testing:** End-to-end review flow validation

---
*Last updated: $(date)*
*Generated for Devocional Nuevo - develop branch*